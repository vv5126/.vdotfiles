#!/bin/bash

function mkinit()
{
	DEST=$(showlist_with_value "$VGLD_MKDATA/cfg" "what project do you want init")
	cp "$VGLD_MKDATA/$DEST" .
	./$DEST init
	return 0
}

function mkmain() {
	local PROJECT_TYPE=$(getdir_git_repo | awk '{print $1}')
	local PROJECT_DIR=$(getdir_git_repo | awk '{print $2}')

	[ -n "$PROJECT_TYPE" -a -n "$PROJECT_DIR" ] && cd $PROJECT_DIR

	if [ ! -f ".project_info" ]; then
		mkinit && echo "init ok" >&2
		return 0
	fi

	local value=
	local key=
	while read line; do
		if [ -f "${line#*=}" ]; then
			value=${line#*=}
			key=${line%%=*}
			break
		fi
	done < "$VGLD_MKDATA/cfg"

	if [ -n "value" ]; then
		echo "this's maybe a $key project" >&2
		./$value $@
		return 0
	else
		echo "NO PROJECT DIR" >&2
		return 1
	fi
}

mkmain $@
