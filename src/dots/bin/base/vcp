#!/bin/bash

source ~/.bin/lib/lib.list

NUM=0
APP_DIR=$(which $0)
APP_DIR=${APP_DIR%\/*}

if [ $# -eq 0 ]; then
	onlyshowlist $APP_DIR/.vcp_conf
	exit
fi

NUM=$@
NUM=${NUM##* }
expr $NUM + 0 &>/dev/null
if [ $? -eq 0 ]; then
	DEST=$(getline $APP_DIR/.vcp_conf $NUM)
	FILES=$@
	FILES=${FILES% *}
else
	if [[ "$NUM" =~ "@" ]]; then
		echo $NUM >> $APP_DIR/.vcp_conf
		DEST=$NUM
		FILES=$@
		FILES=${FILES% *}
	else
		DEST=$(showlist $APP_DIR/.vcp_conf "cp to")
		FILES=$@
	fi
fi

scp -r $FILES $DEST
